# 截屏

## 截屏界面

为了文档描述方便，我们给截屏界面上的元素起一些名字。一般左边有两条竖直下来的白色元素，上面有很多按钮，左边那条称为*工具栏*，右边那条称为*编辑栏*，光标悬浮在编辑栏上，会自动弹出*副编辑栏*，一直跟着光标的是*跟随栏*，顶部是*大小栏*。

工具栏的按钮点击后会触发相应的功能，并一般会关闭截屏界面。

编辑栏（主编辑栏）按钮除了悬浮展开副编辑栏外，直接点击，也可以自动点击副编辑栏的记忆的按钮。比如我上次使用了 形状-矩形、滤镜-马赛克，那么现在点击“形状”按钮，会自动点击副编辑栏的“矩形”按钮，点击“滤镜”按钮等于点击“马赛克”按钮。这样极大地提高了效率。

### 选区

默认设置下，与截屏前显示一样的、鲜艳的色彩区域为选区，选区外则是灰暗的。初始截屏默认全屏选区，这意味着选中了整个屏幕，屏幕没有灰暗处。

按住并拖动鼠标左键，可以选中一个区域。

光标位于选区边缘或选区中间时，光标会改变形状，提示可以拖动。你可以像窗口一样，可以通过拖动改变选区大小、位置，也可以通过方向键改变。

#### 自动框选

当你光标在某个窗口上时，它会提示框选该窗口，点击即可框选。如果启用了记忆框选，将不启用自动框选。

按<kbd>s</kbd>重新框选，无论是否启用记忆框选。

> [!TIP]
>
> 按住<kbd>Shift</kbd>键并进行框选，将匹配合适的窗口框选

#### 自由选择

在编辑栏第一个按钮“选择与操作”切换到自由选择即可绘制任何形状的选区。这个选区只能移动，不能改变。

> [!TIP]
>
> 全屏时可以新建框选，在选区外可以新建选区。所以如果你想要一个比已有选区更小的选区，可以通过<kbd>Ctrl</kbd>+<kbd>A</kbd>改为全屏选区，然后再新建一个小的选区。

### 大小栏

大小栏位于选区上方。分别以像素为单位显示

选区左上角 x 坐标, 选区左上角 y 坐标 选区右下角 x 坐标, 选区右下角 y 坐标 选区长 × 选区宽

等数字。

大小栏的数字可编辑，光标点击你想更改的数字，改变后按下回车键 ↵，即可把数字应用到选区。注意部分数字会随其他数字的改变而改变。

### 鼠标栏

鼠标栏一直跟随着光标，从上到下依次显示放大镜、坐标、颜色代码。

#### 放大镜

放大镜是由若干色块组成的色彩阵，反映了光标位置下屏幕放大后的效果，每个色块都有与之对应的屏幕像素。处于正中间的色块是光标对应屏幕所在位置，他的坐标显示在下面的坐标区。

若色块有灰色边框，整体偏暗，还有些透明，说明它对应的屏幕像素在选区外。

通过放大镜，你可以清除知道光标所在位置，可以更精确进行操作。

#### 颜色代码

展示了光标所在像素的颜色代码，不同的代码格式可以在设置中选择，目前支持：hex、rgb、hsl、hsv、hwb、 lab、Oklab、lch、Oklch 和 cmyk 格式的代码。

#### 更多

右击，鼠标栏将收起放大器，展开颜色代码（所有格式代码，可点击复制），显示选区大小。再次右击可收起。

### 工具栏

展示主要功能按钮。

工具栏会在完成选区框选后自动移动到选区旁。

#### 移动

按住<kbd>Ctrl</kbd>，即可通过拖动改变工具栏位置。

## 图像编辑

### 元素

元素包括笔迹、形状、文字、滤镜等。点击或通过光标拖拉以此选中元素。元素（除了滤镜）被选中后可拖动中间部分来移动，或拖动八个方向的拖块来改变大小，还可以拖动最顶部的拖块来旋转。所有元素都可以通过按下<kbd>Delete</kbd> 键来删除。

### 自由绘画

有画笔、橡皮和喷刷。画笔阴影可以为笔迹添加阴影，使画笔拥有荧光笔性质。

### 形状

#### 线条、圆和矩形

像框选选区一样，选择相应形状后，按下左键并拖动，以此添加形状。

#### 折线和多边形

选择形状后，在你想要的起始位置点击，然后依次点击下一个点来画线，最后在终点双击即可结束画图。多边形会自动闭合形状，例如五边形你只需画四条线。

#### 文字

在你想要的位置点击即可生成文本框。双击编辑文本。

### 滤镜

选择滤镜，拖拉出矩形滤镜区域即可添加。部分滤镜可调节风格程度，如马赛克大小等。

### 颜色和大小

通过点击第一个按钮，可以切换填充颜色和边框颜色设置。线条、箭头等只能更改边框颜色。

上面为颜色输入框，支持输入 CSS 颜色，下半部分可调节不透明度。

#### 色盘

点击颜色，颜色将适用到颜色代码区聚焦位置。原先的不透明度将重设为 100%。右击该颜色，色盘将显示相同色系的更多颜色。再次右击回到主色盘。

### 层次

选择形状、文字、滤镜等元素后，可通过按钮改变他们的层叠顺序。注意，选择元素后，他在视觉上会自动移动到最顶层，实际位置以不选中元素时的位置为准。

### 操作

支持撤销、重做、复制和删除四种操作，复制和删除只针对画布上的元素。撤销和重做针对画布和框选。

#### 复制

相当于电脑中的“复制（拷贝）+粘贴”或 macOS 系统中的“复制”。将会生成画布元素的副本在旁边，你可以在设置调节副本相对蓝本的位置。

#### 删除

选中元素后，进行删除，把他们移除画布。

## 按钮选项

你可以在文字识别、以图搜图和广截屏按钮右上角看到一个小圆点，点击展开更多选项。

文字识别和以图搜图可以更改引擎。

广截屏可以选择长截屏还是广截屏，[文档](long_clip.md)有他们之间区别的介绍。

## 框选后默认操作

框选后，我们手动点击功能按钮来使用相应的功能。我们也可以定义框选后默认执行的操作，比如文字识别，这样在框选后就自动执行了文字识别功能。默认执行的操作对应的按钮使用强调色提示，按下鼠标中键可以取消默认操作。

## 画布导航

通过鼠标滚轮或触摸板滚动，可移动画布。

按住 <kbd>Ctrl</kbd> 键并滚动，可缩放画布。

可通过方向键移动画布一像素，按<kbd>Ctrl</kbd>可实现 5 倍移动，按<kbd>Shift</kbd>可实现 10 倍移动，可叠加速度。

尽管限制了画布的移动范围，使他不会超出窗口，但有时候还是会找不到画布，按<kbd>Ctrl</kbd> + <kbd>0</kbd> 还原画布大小和位置。

---

技巧：

## 拖动条

拖动条用来调节画笔大小、线条粗细、颜色透明度、滤镜值等，你可以在相关位置看到他们。

与一些其他的拖动条不同，它不支持点击来设置值，这样会导致值的突变，并且拖动条比较小，点击也不精确。

所以拖动条值的变化与鼠标拖动水平位移有关，拖动条的范围被映射到 200px 范围内，你可以在很大的一个控件精确地调节拖动条的值。

点击拖动条，你可以直接通过输入数字来改变值。

在一些位置，右键拖动条可以恢复到上一个设置值。

--

高级功能：

## 基于视觉的自动框选

利用 OpenCV 进行图像边缘识别，视觉上重要的选区（图标、文字、导航栏等）可能被识别。需要在设置里开启。

高级设置中的最小阈值和最大阈值是边缘识别算法的参数，你若觉得自动框选不准确，并有相关的知识，可以进行修改。[参考](https://docs.opencv.org/4.x/d7/de1/tutorial_js_canny.html)

## 工具栏自动移动方式

### 展示内容优先

例如：若工具栏将要移动选区左侧，但超出了屏幕，他会移动到选区右侧。若右侧也超出了屏幕，工具栏只能在工具栏左侧内。这种模式最大程度保证工具栏不会遮挡选区，但有可能光标要跨过一个选区点击按钮，效率不高。

### 效率优先

例如：若工具栏将要移动选区左侧，但超出了屏幕，他会移动到选区左侧内，尽管遮挡了选区内容。这种模式保证工具栏尽可能靠近光标，便于提升效率，但它遮挡了选区内容。

## 临时隐藏工具栏

可启用 设置-工具栏-稍后显示，这样截屏时不显示工具栏，第一次框选后才显示。

## 撤销

#### 时间线模式撤销

任何编辑历史都不会在撤销或重做过程丢失，而是以时间为顺序记录当前状态。下面的字母只是比喻。

<table><tbody><tr><td>假设你的编辑过程</td><td>A =&gt; AB =&gt; <strong>ABC</strong></td></tr><tr><td>撤销</td><td>A =&gt; <strong>AB</strong> =&gt; ABC</td></tr><tr><td>在“AB”基础上编辑，如添加D</td><td>A =&gt; AB =&gt; ABC =&gt; AB =&gt; <strong>ABD</strong></td></tr></tbody></table>

#### 撤销&重做

撤销是恢复到当下之前的状态，可以看成回到过去。重做是在撤销后恢复到之后的状态，可以看成回到现在。

<table><tbody><tr><td>假设你的编辑过程</td><td>A =&gt; AB =&gt; <strong>ABC</strong></td></tr><tr><td>撤销</td><td>A =&gt; <strong>AB</strong> =&gt; ABC</td></tr><tr><td>再次撤销</td><td><strong>A</strong> =&gt; AB =&gt; ABC</td></tr><tr><td>重做</td><td>A =&gt; <strong>AB</strong> =&gt; ABC</td></tr></tbody></table>

## 外部截屏器

用于解决部分 Linux glibc 版本过低或截屏库不支持 arm64 架构问题

为了使用截屏功能，需要在 设置-高级 设置截屏命令

```shell
flameshot full -p /dev/shm/esearch-img.png
```

你可以使用 flameshot 或桌面环境的截屏工具，将截屏保存到`/dev/shm/esearch-img.png`（你也可以设置其他位置），**eSearch**会自动识别并打开。

既然都用 flameshot，那用 eSearch 岂不是画蛇添足？虽然 eSearch 在一些方面还比不过 flameshot，但在取色器、OCR 校对、广截屏、搜索翻译等方面我用得还是挺顺手的，建议选择适合自己的工具。

## 托盘截屏样式

部分系统托盘菜单关闭时会有延时。这会影响截屏内容。

在设置源文件中，把`主搜索功能.截屏搜索延迟`改为其他数字（毫秒）
